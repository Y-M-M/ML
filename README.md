# ML
机器学习期末作业

## 模型效果
- final_model 在测试集上达到了91.07%的准确率
- try_model 在测试集上达到了90.48%的准确率


# final_model 模型设计思路总结

基于对代码的分析，`final_model`是一个完整的**自动化机器学习系统**，专门设计用于**仪表读数识别**任务。以下是其核心设计思路：

## 🏗️ 整体设计理念

### 双模型协作架构
该系统采用**两阶段检测识别**的经典方案：
- **第一阶段**：使用YOLO模型进行仪表表盘的检测和定位
- **第二阶段**：使用CRNN模型对检测到的数字区域进行精确识别
- 这种设计避免了端到端方案的复杂性，提高了系统的可解释性和模块化程度

### 渐进式优化策略
设计者采用了**保守改进**的策略：
- 基于已验证有效的架构（准确率79.76%）进行最小化改动
- 避免激进的架构变更，确保模型稳定性
- 通过细微调整逐步提升性能

## 🧠 CRNN模型设计思路

### 卷积特征提取设计
**六层渐进式卷积架构**：
- **浅层**（1-2层）：提取基础边缘和纹理特征，通道数从输入逐步增加到256
- **中层**（3层）：深化特征表示，保持256通道进行特征强化
- **深层**（4-5层）：提取高级语义特征，扩展到512通道，使用非对称池化保持水平序列信息
- **输出层**（6层）：特征压缩层，将特征图压缩为序列形式

### 序列建模设计
**双向LSTM架构**：
- 使用双层双向LSTM捕获数字序列的前后文依赖关系
- 加入dropout防止过拟合
- 隐藏层维度经过精心调优，平衡性能和计算复杂度

### 损失函数选择
采用**CTC损失函数**：
- 解决序列长度不对齐问题
- 支持变长输出序列
- 自动学习最优的字符边界

## 📊 数据处理策略

### 智能数据增强
**保守增强策略**：
- 仅在25%的样本上应用轻微增强
- 主要使用对比度调整等不会破坏数字结构的变换
- 避免过度增强导致的标签噪声

### 数据集划分优化
**图像级别划分**：
- 确保同一图像的所有标注都在同一个数据集中
- 避免数据泄露问题
- 支持自定义划分比例和随机种子

## 🔧 训练优化策略

### 学习率调度
**自适应学习率调整**：
- 使用ReduceLROnPlateau策略
- 当验证损失停止下降时自动降低学习率
- 平衡训练速度和收敛稳定性

### 早停机制
**防过拟合设计**：
- 监控验证损失变化
- 设置合理的耐心值（15轮）
- 自动保存最佳模型状态

### 正则化技术
**多层次正则化**：
- 在RNN层使用dropout
- 在优化器中加入权重衰减
- 通过批量归一化稳定训练

## 🤖 自动化流水线设计

### 端到端自动化
**一键式训练测试**：
- 自动数据集划分和预处理
- 自动模型训练和验证
- 自动测试评估和报告生成
- 支持断点续训和增量实验

### 实验管理
**完整的实验追踪**：
- 记录所有超参数和配置
- 保存详细的训练历史
- 生成结构化的实验报告
- 支持多次实验对比分析

### 容错机制
**鲁棒性保证**：
- 异常处理和错误恢复
- 超时控制防止无限等待
- 资源清理和状态重置
- 详细的日志记录

## 🎯 设计优势

### 模块化设计
- 各组件职责清晰，便于维护和扩展
- 支持独立测试和调优
- 易于集成到更大的系统中

### 可配置性
- 丰富的超参数配置选项
- 支持不同的数据集和任务
- 灵活的训练策略调整

### 工程化导向
- 注重实际部署的可行性
- 考虑计算资源和时间约束
- 提供完整的评估和监控工具

## 📈 性能考量

### 准确性保证
通过保守的架构改进和精心的数据处理，确保模型在保持高准确性的同时具备更好的泛化能力。

### 效率优化
在模型复杂度和计算效率之间找到平衡点，既保证识别精度又控制推理时间。

### 稳定性提升
通过多种正则化技术和训练策略，提高模型的训练稳定性和收敛可靠性。

这个设计体现了**工程实践**和**学术研究**的有机结合，既保证了技术的先进性，又充分考虑了实际应用的需求和约束。
